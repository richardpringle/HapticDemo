<!doctype html>
<html>
  
  <head>
    <meta name="mobile-web-app-capable" content="yes">
    <title>app</title>
    <style type="text/css">
      html, body, canvas {
        height: 100%;
        width: 100%;
        margin: 0;
      }

      #viewport {
        position: relative;
        height: 100%;
        background: #1d1f20;
      }

    </style>

    <script src="/js/socket.io-1.2.0.js"></script>
    <script src="/js/jquery-1.11.1.js"></script>
    <script src="/js/paper-full.js"></script>
    <script type="text/paperscript" canvas="myCanvas">
      var socket = io();

      var topLeft = new Shape.Circle({
        center: new Point(view.bounds.width/2,0),
        radius: 60,
        strokeColor: 'red',
        fillColor: 'red'
      });
      var topRight = new Shape.Circle({
        center: new Point(view.bounds.width, 0),
        radius: 60,
        strokeColor: 'red',
        fillColor: 'red'
      });
      var bottomLeft = new Shape.Circle({
        center: new Point(view.bounds.width/2,view.bounds.height),
        radius: 60,
        strokeColor: 'red',
        fillColor: 'red'
      });
      var bottomRight = new Shape.Circle({
        center:new Point(view.bounds.width,view.bounds.height),
        radius: 60,
        strokeColor: 'red',
        fillColor: 'red'
      });
      var wall = new Path({
        strokeColor: 'red'
      });
      var start = new Point(view.center.x,0); 
      wall.moveTo(start);
      wall.lineTo(start + [0,768]);

      var user = new Shape.Circle({
        center: view.center,
        radius: 60,
        strokeColor: 'DarkGoldenRod',
        strokeWidth: 20
      });

      socket.on('state', function (pos) {
        // rotated 90!!!!!!!
        // var y = map(state[0], -95, 95, 0, 768);
        // var x = map(state[1], 87, 200, 0, 1024);
        var x = pos.x;
        var y = pos.y;
        user.position = new Point(x,y);

        if ((user.position.x - user.radius - 10) < view.center.x) {
          wall.position.x = (user.position.x - user.radius -10);
        }

        view.draw();
      });


    </script>

  </head>
  
  <body>

    <div id="viewport">
      <canvas id="myCanvas" resize="true"></canvas>
    </div>

  </body>

</html>

